{"messages": [{"role": "system", "content": "Clippy is a factual chatbot that assist about the Azure Security Policy."},{"role": "user", "content": "Write a condition to deny access if the field name does not match the patterns contoso?????? and contoso-???-##."},{"role": "assistant","content": "If all of the field is name does not match contoso?????? and does not match contoso-???-##, then deny."}]}
{"messages": [{"role": "system", "content": "Clippy is a factual chatbot that assist about the Azure Security Policy."},{"role": "user", "content": "Create a policy to restrict access when the value of name doesn't conform to the patterns contoso?????? and contoso-???-##."},{"role": "assistant","content": "If all of the field is name does not match contoso?????? and does not match contoso-???-##, then deny."}]}
{"messages": [{"role": "system", "content": "Clippy is a factual chatbot that assist about the Azure Security Policy."},{"role": "user", "content": "Construct a condition to evaluate if the field type matches Microsoft.Network/expressRouteCircuits and if the field Microsoft.Network/expressRouteCircuits/serviceProvider.bandwidthInMbps is not included in the list provided by the parameter listOfBandwidthinMbps. If this condition is met, what should be the action taken?"},{"role": "assistant","content": "If all of the field is type is Microsoft.Network/expressRouteCircuits and the field is Microsoft.Network/expressRouteCircuits/serviceProvider.bandwidthInMbps is not in the list of [parameters(listOfBandwidthinMbps)], then deny."}]}
{"messages": [{"role": "system", "content": "Clippy is a factual chatbot that assist about the Azure Security Policy."},{"role": "user", "content": "Design a rule to check if all entries in the type field are tagged as Microsoft.Network/expressRouteCircuits, and simultaneously ensure that the bandwidthInMbps field within Microsoft.Network/expressRouteCircuits does not match any values specified in the parameter listOfBandwidthinMbps. What action should be triggered if this condition holds true?"},{"role": "assistant","content": "If all of the field is type is Microsoft.Network/expressRouteCircuits and the field is Microsoft.Network/expressRouteCircuits/serviceProvider.bandwidthInMbps is not in the list of [parameters(listOfBandwidthinMbps)], then deny."}]}
{"messages": [{"role": "system", "content": "Clippy is a factual chatbot that assist about the Azure Security Policy."},{"role": "user", "content": "Construct a policy condition to enforce denial if all resources are of type Microsoft.Network/expressRouteCircuits and their serviceProvider.peeringLocation field does not match any location from the specified list."},{"role": "assistant","content": "If all of the field is type equals Microsoft.Network/expressRouteCircuits and the field Microsoft.Network/expressRouteCircuits/serviceProvider.peeringLocation is not in the list of [parameters(listOfLocations)], then deny."}]}
{"messages": [{"role": "system", "content": "Clippy is a factual chatbot that assist about the Azure Security Policy."},{"role": "user", "content": "Create a policy rule ensuring denial for all instances categorized under Microsoft.Network/expressRouteCircuits if their serviceProvider.peeringLocation attribute is not among the designated locations."},{"role": "assistant","content": "If all of the field is type equals Microsoft.Network/expressRouteCircuits and the field Microsoft.Network/expressRouteCircuits/serviceProvider.peeringLocation is not in the list of [parameters(listOfLocations)], then deny."}]}
{"messages": [{"role": "system", "content": "Clippy is a factual chatbot that assist about the Azure Security Policy."},{"role": "user", "content": "Describe a condition where access is denied based on specific criteria related to virtual network gateways."},{"role": "assistant","content": "If all of the field is type equals Microsoft.Network/virtualNetworkGateways and the field equals Microsoft.Network/virtualNetworkGateways/gatewayType and the field Microsoft.Network/virtualNetworkGateways/sku.name is not in the list of [parameters(listOfAllowedSKUs)], then deny."}]}
{"messages": [{"role": "system", "content": "Clippy is a factual chatbot that assist about the Azure Security Policy."},{"role": "user", "content": "How would you construct a policy to restrict access to virtual network gateways based on their types and SKUs?"},{"role": "assistant","content": "If all of the field is type equals Microsoft.Network/virtualNetworkGateways and the field equals Microsoft.Network/virtualNetworkGateways/gatewayType and the field Microsoft.Network/virtualNetworkGateways/sku.name is not in the list of [parameters(listOfAllowedSKUs)], then deny."}]}
{"messages": [{"role": "system", "content": "Clippy is a factual chatbot that assist about the Azure Security Policy."},{"role": "user", "content": "Describe a condition to handle tag appending: If a specific tag, formed by concatenating a parameterized tag name, doesn't exist, what action should be taken?"},{"role": "assistant","content": "If the field [concat(tags[parameters(tagName)])] does not exist, then append [parameters(tagValue)] to the field [concat(tags[ parameters(tagName)])]."}]}
{"messages": [{"role": "system", "content": "Clippy is a factual chatbot that assist about the Azure Security Policy."},{"role": "user", "content": "Can you outline a scenario where a tag needs to be added to a resource if it's missing?"},{"role": "assistant","content": "If the field [concat(tags[parameters(tagName)])] does not exist, then append [parameters(tagValue)] to the field [concat(tags[ parameters(tagName)])]."}]}
{"messages": [{"role": "system", "content": "Clippy is a factual chatbot that assist about the Azure Security Policy."},{"role": "user", "content": "Craft a condition to evaluate whether the type field equals Microsoft.Compute/virtualMachines and if the imageId field is not among the specified list of image IDs, then take action to deny access."},{"role": "assistant","content": "If all of the field is type equals to Microsoft.Compute/virtualMachines and the field Microsoft.Compute/imageId is not in the list of [parameters(imageIds)], then deny."}]}
{"messages": [{"role": "system", "content": "Clippy is a factual chatbot that assist about the Azure Security Policy."},{"role": "user", "content": "Develop a policy rule that enforces denial if a resource's type is Microsoft.Compute/virtualMachines and its imageId is not included in the defined set of image IDs."},{"role": "assistant","content": "If all of the field is type equals to Microsoft.Compute/virtualMachines and the field Microsoft.Compute/imageId is not in the list of [parameters(imageIds)], then deny."}]}
{"messages": [{"role": "system", "content": "Clippy is a factual chatbot that assist about the Azure Security Policy."},{"role": "user", "content": "Detail the audit requirements for Microsoft.Network/virtualNetworks in relation to Microsoft.Network/networkWatchers."},{"role": "assistant","content": "If the field is type equals to Microsoft.Network/virtualNetworks, then audit if a resource of type Microsoft.Network/networkWatchers in the NetworkWatcherRG resource group exists with the location equal to [parameters(azLocation)]."}]}
{"messages": [{"role": "system", "content": "Clippy is a factual chatbot that assist about the Azure Security Policy."},{"role": "user", "content": "Outline the criteria for auditing Microsoft.Network/virtualNetworks resources."},{"role": "assistant","content": "If the field is type equals to Microsoft.Network/virtualNetworks, then audit if a resource of type Microsoft.Network/networkWatchers in the NetworkWatcherRG resource group exists with the location equal to [parameters(azLocation)]."}]}
{"messages": [{"role": "system", "content": "Clippy is a factual chatbot that assist about the Azure Security Policy."},{"role": "user", "content": "Discuss the conditions necessary to initiate an audit for virtual networks within a specific resource group and location."},{"role": "assistant","content": "If the field is type equals to Microsoft.Network/virtualNetworks, then audit if a resource of type Microsoft.Network/networkWatchers in the NetworkWatcherRG resource group exists with the location equal to [parameters(azLocation)]."}]}
{"messages": [{"role": "system", "content": "Clippy is a factual chatbot that assist about the Azure Security Policy."},{"role": "user", "content": "Create a policy condition to check if the tags field lacks keys such as CreatedBy, CreatedDate, NS_Application, NS_Environment, and NS_Location. Additionally, ensure it either contains the key NS_Function or none of the mentioned keys, and then set it to trigger an audit."},{"role": "assistant","content": "If the field tags do not contain keys CreatedBy, CreatedDate, NS_Application, NS_Environment, NS_Location, and either contain key NS_Function or not contain any of these keys, then audit."}]}
{"messages": [{"role": "system", "content": "Clippy is a factual chatbot that assist about the Azure Security Policy."},{"role": "user", "content": "Develop a policy condition to audit if certain tags are missing or not properly structured. Specifically, ensure that the tags field doesn't include keys like CreatedBy, CreatedDate, NS_Application, NS_Environment, and NS_Location, and also ensure it contains the key NS_Function or none of the mentioned keys."},{"role": "assistant","content": "If the field tags do not contain keys CreatedBy, CreatedDate, NS_Application, NS_Environment, NS_Location, and either contain key NS_Function or not contain any of these keys, then audit."}]}
{"messages": [{"role": "system", "content": "Clippy is a factual chatbot that assist about the Azure Security Policy."},{"role": "user", "content": "Craft a condition for policy enforcement that scrutinizes the presence and arrangement of tags. Verify that the tags field is devoid of keys such as CreatedBy, CreatedDate, NS_Application, NS_Environment, and NS_Location, while also confirming the presence of the key NS_Function or none of the mentioned keys, and then schedule an audit accordingly."},{"role": "assistant","content": "If the field tags do not contain keys CreatedBy, CreatedDate, NS_Application, NS_Environment, NS_Location, and either contain key NS_Function or not contain any of these keys, then audit."}]}
{"messages": [{"role": "system", "content": "Clippy is a factual chatbot that assist about the Azure Security Policy."},{"role": "user", "content": "Create a condition to deny access if the virtual machine's SKU name matches any of the denied VM sizes listed in a parameter."},{"role": "assistant","content": "If all of the field is type equals to Microsoft.Compute/virtualMachines and the virtual machine SKU name is in the list of denied VM sizes specified in [parameters(listOfDeniedVMSizes)], then deny."}]}
{"messages": [{"role": "system", "content": "Clippy is a factual chatbot that assist about the Azure Security Policy."},{"role": "user", "content": "Detail a scenario where access is denied to Microsoft.Compute/virtualMachines instances if their SKU name falls within a specified list of denied sizes."},{"role": "assistant","content": "If all of the field is type equals to Microsoft.Compute/virtualMachines and the virtual machine SKU name is in the list of denied VM sizes specified in [parameters(listOfDeniedVMSizes)], then deny."}]}
{"messages": [{"role": "system", "content": "Clippy is a factual chatbot that assist about the Azure Security Policy."},{"role": "user", "content": "How would you construct a policy to restrict certain virtual machine sizes in a Microsoft.Compute/virtualMachines context?"},{"role": "assistant","content": "If all of the field is type equals to Microsoft.Compute/virtualMachines and the virtual machine SKU name is in the list of denied VM sizes specified in [parameters(listOfDeniedVMSizes)], then deny."}]}